<div class="detail-container" *ngIf="application">
  <div class="app-header">
    <div class="info">
      <h1>{{ application.name }}</h1>
      <p class="description">{{ application.description }}</p>
      <a *ngIf="application.url" [href]="application.url" target="_blank" class="btn-link">
        {{ 'Visit URL' | translate }}
      </a>
      <button class="btn btn-primary" *ngIf="canEditApplication()" (click)="goToEdit()">Editar Application</button>
    </div>
    <div class="meta">
      <span>{{ 'Created:' | translate }} {{ application.createdAt | date:'medium' }}</span>
      <span>
        {{ 'Status:' | translate }}
        <span class="status" [ngClass]="application.available ? 'available' : 'unavailable'">
          {{ application.available ? ('Available'|translate) : ('Unavailable'|translate) }}
        </span>
      </span>
    </div>
  </div>

  <section class="tickets-section">
    <h2>{{ 'Tickets' | translate }}</h2>
    <div class="tickets-grid">
      <div *ngFor="let tk of tickets" class="ticket-card">
        <div class="ticket-header">
          <h3>{{ tk.title }}</h3>
          <span class="ticket-status">{{ tk.status }}</span>
        </div>
        <p class="ticket-desc">{{ tk.description }}</p>
        <div class="comments">
          <h4>{{ 'Comments' | translate }}</h4>
          <div *ngFor="let c of commentsMap[tk.id]" class="comment-item">
            <strong>{{ c.authorName }}:</strong>
            <span>{{ c.comment }}</span>
            <small>{{ c.createdAt | date:'short' }}</small>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="new-ticket-section">
    <h2>{{ 'New Ticket' | translate }}</h2>
    <form [formGroup]="ticketForm" (ngSubmit)="submitTicket()" class="ticket-form">
      <div class="form-group">
        <label>{{ 'Title' | translate }}</label>
        <input formControlName="title" placeholder="{{ 'Enter title'|translate }}" />
      </div>
      <div class="form-group">
        <label>{{ 'Description' | translate }}</label>
        <textarea formControlName="description" placeholder="{{ 'Enter description'|translate }}"></textarea>
      </div>
      <button type="submit" [disabled]="ticketForm.invalid" class="btn-submit">
        {{ 'Create Ticket' | translate }}
      </button>
    </form>
  </section>
</div>